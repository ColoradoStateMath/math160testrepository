\documentclass{ximera}

\input{../preamble.tex}

\title[Dig-In]{Concavity and the 2nd Derivative Test}

\outcome{State the Second Derivative Test.}
\outcome{Apply the Second Derivative Test.}
\outcome{Define inflection points.}
\outcome{Find inflection points.}
  
\begin{document}
\begin{abstract}
  Here we examine what the second derivative tells us about the
  geometry of functions.
\end{abstract}
\maketitle

%%CONCAVITY%%

\section{Concavity}

We know that the sign of the derivative tells us whether a function is
increasing or decreasing at some point. Likewise, the sign of the
second derivative $f''(x)$ tells us whether $f'(x)$ is increasing or
decreasing at $x$. We summarize the consequences of this seemingly
simple idea in the table below:

\begin{image}
  \begin{tikzpicture}
    \draw (0,0) -- (0,12);
    \draw (0,0) -- (12,0);
    \draw (6,0) -- (6,12);
    \draw (0,6) -- (12,6);
    \draw (12,0) -- (12,12);
    \draw (0,12) -- (12,12);
    
    \node at (-1.3,9) {\Large$0<f''(x)$};
    \node at (-1.3,3) {\Large$f''(x)<0$};
    \node at (3,12.4) {\Large$f'(x)<0$};
    \node at (9,12.4) {\Large$0<f'(x)$};
    
    \draw [penColor,ultra thick,domain=180:270] plot ({2*cos(\x)+4}, {2*sin(\x)+11});
    \draw [penColor,ultra thick,domain=270:360] plot ({2*cos(\x)+8}, {2*sin(\x)+11});
    \draw [penColor,ultra thick,domain=0:90] plot ({2*cos(\x)+2}, {2*sin(\x)+3});
    \draw [penColor,ultra thick,domain=180:90] plot ({2*cos(\x)+10}, {2*sin(\x)+3});

    \node at (3,7.5) [text width=5cm] {\large
      Here $f(x)$ is decreasing, while the rate of change of $f(x)$ is increasing.
      In this case the curve is \dfn{concave up}.};

    \node at (9,7.5) [text width=5cm] {\large
      Here $f(x)$ is increasing, while the rate of change of $f(x)$ is increasing.
      In this case the curve is \dfn{concave up}.};

    \node at (3,1.5) [text width=5cm] {\large
      Here $f(x)$ is decreasing, while the rate of change of $f(x)$ is decreasing.
      In this case the curve is \dfn{concave down}.};

    \node at (9,1.5) [text width=5cm] {\large
      Here $f(x)$ is increasing, while the rate of change of $f(x)$ is decreasing.
      In this case the curve is \dfn{concave down}.};
  \end{tikzpicture}
\end{image}

If we are trying to understand the shape of the graph of a function,
knowing where it is concave up and concave down helps us to get a more
accurate picture. It is worth summarizing what we have seen already in a single theorem.

\begin{theorem}[Test for Concavity]\index{concavity test}
Suppose that $f''(x)$ exists on an interval.
\begin{enumerate}
\item $f''(x)>0$ on that interval whenever $y=f(x)$ is concave up on that interval.
\item $f''(x)<0$ on that interval whenever $y=f(x)$ is concave down on that interval.
\end{enumerate}
\end{theorem}


\begin{example}
  Let $f$ be a continuous function and suppose that:
  \begin{itemize}
  \item $f'(x) > 0$ for $-1< x<1$.
  \item $f'(x) < 0$ for $-2< x<-1$ and $1<x<2$.
  \item $f''(x) > 0$ for $-2<x<0$ and $1<x< 2$.
  \item $f''(x) < 0$ for $0<x< 1$.  
  \end{itemize}
  Sketch a possible graph of $f$.
  \begin{explanation}
    Start by marking where the derivative changes sign and indicate
    intervals where $f$ is increasing and intervals $f$ is
    decreasing. The function $f$ has a negative derivative from $-2$
    to $x=\answer[given]{-1}.$ This means that $f$ is
    \wordChoice{\choice{increasing}\choice[correct]{decreasing}} on
    this interval. The function $f$ has a positive derivative from
    $x=\answer[given]{-1}$ to $x=\answer[given]{1}.$ This means that
    $f$ is
    \wordChoice{\choice[correct]{increasing}\choice{decreasing}} on
    this interval. Finally, The function $f$ has a negative derivative
    from $x=\answer[given]{1}$ to $2$. This means that $f$ is
    \wordChoice{\choice{increasing}\choice[correct]{decreasing}} on
    this interval.
  \begin{image}
    \begin{tikzpicture}
    \begin{axis}[
        xmin=-2,xmax=2,ymin=-2,ymax=2,
        axis lines=center,
        width=6in,
        height=3in,
        every axis y label/.style={at=(current axis.above origin),anchor=south},
        every axis x label/.style={at=(current axis.right of origin),anchor=west},
      ]
      \addplot [dashed, penColor2] plot coordinates {(-1,-2) (-1,2)}; %% Critical points
      \addplot [dashed, penColor2] plot coordinates {(1,-2) (1,2)}; %% Critical points

      \addplot [->, line width=10, penColor!10!background] plot coordinates {(-1+.2,-2+.2) (1-.2,2-.2)};
      \addplot [->, line width=10, penColor!10!background] plot coordinates {(-2+.2,2-.2) (-1-.2,-2+.2)};
      \addplot [->, line width=10, penColor!10!background] plot coordinates {(1+.2,2-.2) (2-.2,-2+.2)}; 
      
      %\addplot [very thick,penColor,smooth, domain=(-2:2)] {x^3+x^2-2*x)};
    \end{axis}
  \end{tikzpicture}
  \end{image}
  Now we should sketch the concavity: \wordChoice{\choice[correct]{concave up}\choice{concave down}} when the second
  derivative is positive, \wordChoice{\choice{concave up}\choice[correct]{concave down}} when the second derivative is
  negative.
    \begin{image}
    \begin{tikzpicture}
    \begin{axis}[
        xmin=-2,xmax=2,ymin=-2,ymax=2,
        axis lines=center,
        width=6in,
        height=3in,
        every axis y label/.style={at=(current axis.above origin),anchor=south},
        every axis x label/.style={at=(current axis.right of origin),anchor=west},
      ]
      \addplot [dashed, penColor2] plot coordinates {(-1,-2) (-1,2)}; %% Critical points
      \addplot [dashed, penColor2] plot coordinates {(1,-2) (1,2)}; %% Critical points

      %\addplot [->, line width=10, penColor!10!background] plot coordinates {(-1+.2,-2+.2) (1-.2,2-.2)};
      %\addplot [->, line width=10, penColor!10!background] plot coordinates {(-2+.2,2-.2) (-1-.2,-2+.2)};
      %\addplot [->, line width=10, penColor!10!background] plot coordinates {(1+.2,2-.2) (2-.2,-2+.2)};

      \addplot [penColor3!20!background,line width=10,domain=180:270] ({-1.1+.7*cos(x)}, {1.2+2*sin(x)});
      \addplot [penColor3!20!background,line width=10,domain=270:360] ({-.9+.7*cos(x)}, {-.1+.7*sin(x)});
      \addplot [penColor3!20!background,line width=10,domain=180:90] ({.9+.7*cos(x)}, {.1+.7*sin(x)});
      \addplot [penColor3!20!background,line width=10,domain=180:265] ({1.9+.7*cos(x)}, {.9+ 2*sin(x)});

      \addplot [->, line width=10, penColor3!20!background] plot coordinates {(-1.1,-.1-.7) (-1,-.1-.7)};
      \addplot [->, line width=10, penColor3!20!background] plot coordinates {(.9,.1+.7) (1,.1+.7)};
      
      \addplot [->, line width=10, penColor3!20!background] plot coordinates {(-.9+.7,-.2) (-.9+.8,.2)};
      \addplot [->, line width=10, penColor3!20!background] plot coordinates {(1.8,-1.1) (2,-1.2)};
      
      %\addplot [very thick,penColor,smooth, domain=(-2:2)] {x^3+x^2-2*x)};
    \end{axis}
  \end{tikzpicture}
    \end{image}
    Finally, we can sketch our curve:
        \begin{image}
    \begin{tikzpicture}
    \begin{axis}[
        xmin=-2,xmax=2,ymin=-2,ymax=2,
        axis lines=center,
        width=6in,
        height=3in,
        every axis y label/.style={at=(current axis.above origin),anchor=south},
        every axis x label/.style={at=(current axis.right of origin),anchor=west},
      ]
      \addplot [dashed, penColor2] plot coordinates {(-1,-2) (-1,2)}; %% Critical points
      \addplot [dashed, penColor2] plot coordinates {(1,-2) (1,2)}; %% Critical points

      \addplot [penColor,ultra thick,domain=-2:1,smooth] {(-x^3+3*x)*.5};
      \addplot [penColor,ultra thick,domain=1:2,smooth] {(-(x-3)^3+3*(x-3))*.5};
    \end{axis}
  \end{tikzpicture}
  \end{image}
  \end{explanation}
\end{example}


%%INFLECTION POINTS%%
\section{Inflection points}

If we are trying to understand the shape of the graph of a function,
knowing where it is concave up and concave down helps us to get a more
accurate picture.  Of particular interest are points at which the concavity changes from
up to down or down to up.  

\begin{definition}\index{inflection point}
If the concavity of $f$ changes either from up to down
or down to up at $x=a$ and $f$ has a tangent line at $x=a$, then $x=a$ is an \dfn{inflection point} of $f.$
\end{definition}

It is instructive to see some examples of inflection points:
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            %height=7cm,
            %width=2in,
            width=6in,
            height=2in,
            %ymax=8,
            %ymin=-1,
            axis lines=none,
            clip=false,
          ]
          \addplot [very thick, penColor, smooth, domain=(0:1)] {(x-1)^2+1};
          \addplot [very thick, penColor, smooth, domain=(1:2)] {-(x-1)^2+1};
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(1,1)};
          \node at (axis cs:1,-.5) [text width=2in] {The concavity changes from concave up to concave down at the indicated point, so the $x$-coordinate of the point is an inflection point.};
        
          \addplot [very thick, penColor, smooth,domain=(4:5)] {-sqrt(abs(1-(x-4)))+1};
          \addplot [very thick, penColor, smooth,domain=(5:6)] {sqrt((x-4)-1)+1};
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(5,1)};
          \node at (axis cs:5,-.5) [text width=2in] {The concavity changes from concave up to concave down, so the $x$-coordinate of the point is an inflection point.};
        \end{axis}
\end{tikzpicture}
\end{image}

It is also instructive to see some non-examples of inflection points:
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            %height=7cm,
            %width=2in,
            width=6in,
            height=2in,
            %ymax=8,
            %ymin=-1,
            axis lines=none,
            clip=false,
          ]
          \addplot [very thick, penColor2, smooth, domain=(0:2)] {-(x-1)^2+1};
          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(1,1)};
          \node at (axis cs:1,-.5) [text width=2in] {The $x$ value of this point is \textbf{not} an inflection point because the curve is concave down on either side of the point.};
          \addplot [very thick, penColor2, smooth,domain=(4:5)] {sqrt(abs(1-(x-4)))};
          \addplot [very thick, penColor2, smooth,domain=(5:6)] {sqrt(x-5)};
          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(5,0)};
          \node at (axis cs:5,-.5) [text width=2in] {The $x$ value of this point is also \textbf{not} an inflection point because the curve is concave down on either side of the point.  Also, no tangent line can be drawn to the indicated point because there is a cusp.};
        \end{axis}
\end{tikzpicture}
\end{image}

We identify inflection points by first finding $x$ such that $f''(x)$
is zero or undefined and then checking to see whether $f''(x)$ does in
fact go from positive to negative or negative to positive at these
points.

\begin{warning}
Even if $f''(a) = 0$, the point determined by $x=a$ might \textbf{not}
be an inflection point.  You also need to check that concavity of $f$ changes on either side of $x=a.$  
\end{warning}


\begin{example}
Describe the concavity of $f(x)=x^3-x$. 

\begin{explanation}
To start, compute the first and second derivative of $f(x)$ with
respect to $x$,
\[
f'(x)=\answer[given]{3x^2-1}\qquad\text{and}\qquad f''(x)=\answer[given]{6x}.
\]
Since $f''(0)=0$, there is potentially an inflection point at
$x=0$. Using test points, we note the concavity does change from down
to up, hence $x=0$ is an inflection point of $f.$  The curve is
concave down for all $x<0$ and concave up for all $x>0$, see the
graphs of $f(x) = x^3-x$ and $f''(x) = 6x$.
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-3:3,
            ymax=3,
            ymin=-3,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [very thick, penColor, smooth] {x^3-x};
          \addplot [very thick, penColor4, smooth] {6*x};         
          \node at (axis cs:-.75,.6) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:.2,1) [anchor=west] {\color{penColor4}$f''$};
          \addplot[color=penColor4!50!penColor,fill=penColor4!50!penColor,only marks,mark=*] coordinates{(0,0)};  %% closed hole
        \end{axis}
\end{tikzpicture}
%% \caption{A plot of $f(x) = x^3-x$ and $f''(x) = 6x$. We can see that
%%   the concavity change at $x=0$.}
%% \label{figure:3x^2-1}
%% \end{marginfigure}
\end{image}
\end{explanation}
\end{example}

Note that we need to compute and analyze the second derivative to understand concavity, which can help us to identify whether critical points correspond to maxima or minima.  Sometimes, rather than using the first derivative test for extrema, the second derivative test can also help you to identify extrema.

\section{The second derivative test}


Recall the first derivative test:
\begin{itemize}
\item If $f'(x)>0$ to the left of $a$ and $f'(x)<0$ to the right of
  $a$, then $f(a)$ is a local maximum.
\item If $f'(x)<0$ to the left of $a$ and $f'(x)>0$ to the right of
  $a$, then $f(a)$ is a local minimum.
\end{itemize}

If $f'$ changes from positive to negative, then $f'$ is decreasing. In this
case, $f''$ might be negative, and if in fact $f''$ is negative
then $f'$ is definitely decreasing, so there is a local maximum at
the point in question. On the other hand, if $f'$ changes from
negative to positive, then $f'$ is increasing. Again, this means that
$f''$ might be positive, and if in fact $f''$ is positive then
$f'$ is definitely increasing, so there is a local minimum at the
point in question. We summarize this as the \textit{second derivative
  test}.

\begin{theorem}[Second Derivative Test]\index{second derivative test}\label{T:sdt}
Suppose that $f''(x)$ is continuous on an open interval containing $x=a$ and that
$f'(a)=0$ for some value of $a$ in that interval.
\begin{itemize}
\item If $f''(a) <0$, then $f$ has a local maximum at $a$.
\item If $f''(a) >0$, then $f$ has a local minimum at $a$.
\item If $f''(a) =0$, then the test is inconclusive. In this case,
  $f$ may or may not have a local extremum at $x=a$, and the first derivative test should be used to find out.
\end{itemize}
\end{theorem}


In certain situations, when the second derivative is easy to calculate, the second derivative test is often the easiest way to identify local extrema.  However, if the second derivative is difficult to calculate, you may want to stick with the first derivative test.  Also, if $f(x)$ has a critical point, $x=a$ at which $f'(a)$ is undefined, the second derivative test does not apply, which means you'll want to use the first derivative test instead.  To add to this, even if the second derivative is easy to calculate, if it turns out that $f''(a) = 0$, then $f(x)$ is neither concave up nor concave down at $x=a$, so no conclusions can be made using concavity/the second derivative about whether $x=a$ corresponds to a local maximum or minimum.  

\begin{example}
Once again, consider the function 
\[
f(x) = \frac{x^4}{4}+\frac{x^3}{3}-x^2
\]
Use the second derivative test, to locate the
local extrema of $f$.

\begin{explanation}
Start by computing
\[
f'(x) = \answer[given]{x^3 + x^2 -2x} \qquad\text{and}\qquad f''(x) = \answer[given]{3x^2 + 2x-2}.
\] 
Using the same technique as we used before, we find that 
\[
f'(-2) = \answer[given]{0},\qquad f'(0) = \answer[given]{0}, \qquad f'(1) = \answer[given]{0}. 
\]
Now we'll attempt to use the second derivative test,
\[
f''(-2) = \answer[given]{6}, \qquad f''(0) =\answer[given]{ -2}, \qquad f''(1) = \answer[given]{3}.
\]
Hence we see that $f$ has a local minimum at $x=-2$, a local
maximum at $x=0$, and a local minimum at $x=1$ by applying the second derivative test.  See below for a plot
of $f(x) =x^4/4 + x^3/3 -x^2$ and $f''(x) = 3x^2 + 2x -2$:
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-4:4,
            ymax=7,
            ymin=-4,
            %samples=100,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [dashed, textColor, smooth] plot coordinates {(-2,-2.667) (-2,6)}; %% {.451};
          \addplot [dashed, textColor, smooth] plot coordinates {(1,0) (1,3)}; %% axis{2.215};

          \addplot [very thick, penColor, smooth] {(x^4)/4 + (x^3)/3 -x^2};
          \addplot [very thick, penColor4, smooth] {3*x^2 + 2*x -2};

          \node at (axis cs:-1.7,-2.7) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:-1.5,2) [anchor=west] {\color{penColor4}$f''$};

          \addplot[color=penColor4,fill=penColor4,only marks,mark=*] coordinates{(-2,6)};  %% closed hole
          \addplot[color=penColor4,fill=penColor4,only marks,mark=*] coordinates{(1,3)};  %% closed hole
          \addplot[color=penColor4,fill=penColor4,only marks,mark=*] coordinates{(0,-2)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(0,0)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(-2,.-2.667)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(1,-.4167)};  %% closed hole
        \end{axis}
\end{tikzpicture}
%% \caption{A plot of $f(x) =x^4/4 + x^3/3 -x^2$ and $f''(x) = 3x^2 + 2x -2$.}
%% \label{figure:SDT(x^4)/4 + (x^3)/3 -x^2}
\end{image}

\end{explanation}
\end{example}


\begin{problem}
  If $f''(a)=0$, what does the second derivative test tell us?
  \begin{multipleChoice}
    \choice{The function has a local extrema at $x=a$.}
    \choice{The function does not have a local extrema at $x=a$.}
    \choice[correct]{It gives no information on whether $x=a$ is a local extremum.} 
  \end{multipleChoice}
  
\end{problem}



\end{document}
